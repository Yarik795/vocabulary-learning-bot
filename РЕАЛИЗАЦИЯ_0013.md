# ‚úÖ –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–ª–∞–Ω–∞ 0013: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—É—Ç–µ–π —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è Amvera

## üìÖ –î–∞—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
27 –æ–∫—Ç—è–±—Ä—è 2025

## üéØ –ó–∞–¥–∞—á–∞
–ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—É—Ç–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ø–∞–ø–∫–∏ `/app/data/` (–∫–æ—Ç–æ—Ä–∞—è —Ç–µ—Ä—è–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–µ) –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é `/data/` (Persistent Storage –≤ Amvera).

## üìù –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1Ô∏è‚É£ –§–∞–∑–∞ 1: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (config/settings.py)

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å—Ç—Ä–æ–∫–∞—Ö 29-44:**

–°—Ç–∞—Ä—ã–π –ø–æ–¥—Ö–æ–¥:
```python
BASE_DIR = Path(__file__).parent.parent
DATA_DIR = BASE_DIR / "data"                    # ‚Üí /app/data/
AUDIO_CACHE_DIR = DATA_DIR / "audio_cache"     # ‚Üí /app/data/audio_cache/
VARIANTS_CACHE_DIR = DATA_DIR / "variants_cache"
LOGS_DIR = BASE_DIR / "logs"                   # ‚Üí /app/logs/
```

–ù–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥ (—Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π production –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏):
```python
if os.path.exists("/data"):
    # Production: Amvera —Å persistent storage
    DATA_DIR = Path("/data")
    LOGS_DIR = Path("/data/logs")
else:
    # –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞: –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø—É—Ç–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
    BASE_DIR = Path(__file__).parent.parent
    DATA_DIR = BASE_DIR / "data"
    LOGS_DIR = BASE_DIR / "logs"

# –ü—Ä–æ–∏–∑–≤–æ–¥–Ω—ã–µ –ø—É—Ç–∏ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–º–µ—Å—Ç—è—Ç—Å—è –≤ /data/ –Ω–∞ production)
AUDIO_CACHE_DIR = DATA_DIR / "audio_cache"
VARIANTS_CACHE_DIR = DATA_DIR / "variants_cache"
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ Production (Amvera): –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `/data/` (Persistent Storage)
- ‚úÖ –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞: –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø—É—Ç–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –ü–æ–ª–Ω–∞—è backward compatibility
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ –Ω–∞–ª–∏—á–∏—é –ø–∞–ø–∫–∏ `/data/`

### 2Ô∏è‚É£ –§–∞–∑–∞ 2: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ main.py

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å—Ç—Ä–æ–∫–∞—Ö 248-252:**

–°—Ç–∞—Ä—ã–π –ø–æ–¥—Ö–æ–¥:
```python
if __name__ == "__main__":
    from pathlib import Path
    LOGS_DIR = Path(__file__).parent / "logs"  # ‚ùå –õ–æ–∫–∞–ª—å–Ω—ã–π –ø—É—Ç—å
    LOGS_DIR.mkdir(parents=True, exist_ok=True)
```

–ù–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥:
```python
if __name__ == "__main__":
    # ‚ö†Ô∏è –í–ê–ñ–ù–û: –°–æ–∑–¥–∞—ë–º –ø–∞–ø–∫—É –ª–æ–≥–æ–≤ –î–û –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
    # FileHandler –Ω–µ —Å–æ–∑–¥–∞—ë—Ç –ø–∞–ø–∫—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –ø–æ—ç—Ç–æ–º—É –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ –≤—Ä—É—á–Ω—É—é
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º LOGS_DIR –∏–∑ settings (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–∞–∫ –ª–æ–∫–∞–ª—å–Ω—ã–µ, —Ç–∞–∫ –∏ production –ø—É—Ç–∏)
    LOGS_DIR.mkdir(parents=True, exist_ok=True)
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è LOGS_DIR –∏–∑ config/settings.py
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–∞–∫ –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø—É—Ç–∏, —Ç–∞–∫ –∏ production –ø—É—Ç–∏ `/data/logs/`

## üìä –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

–≠—Ç–∏ —Ñ–∞–π–ª—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –Ω–æ–≤—ã–µ –ø—É—Ç–∏ –±–ª–∞–≥–æ–¥–∞—Ä—è –∏–º–ø–æ—Ä—Ç–∞–º –∏–∑ config/settings.py:

1. **src/utils/file_helpers.py** (—Å—Ç—Ä–æ–∫–∞ 11)
   - –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç `DATA_DIR`
   - `TEMP_SESSIONS_DIR = DATA_DIR / "temp_sessions"` ‚Üí `/data/temp_sessions/`
   - –ü—É—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: `/data/users/{user_id}/`

2. **src/services/tts_service.py** (—Å—Ç—Ä–æ–∫–∞ 13)
   - –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç `AUDIO_CACHE_DIR`
   - –ö—ç—à –∞—É–¥–∏–æ: ‚Üí `/data/audio_cache/`

3. **src/services/variant_generator_service.py** (—Å—Ç—Ä–æ–∫–∞ 12)
   - –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç `VARIANTS_CACHE_DIR`
   - –ö—ç—à –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤: ‚Üí `/data/variants_cache/`

## üîÑ –ü–æ–≤–µ–¥–µ–Ω–∏–µ –≤ —Ä–∞–∑–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è—Ö

### üñ•Ô∏è –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
- –ü—Ä–æ–≤–µ—Ä–∫–∞: `/data` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –ø—É—Ç–∏ `./data/`, `./logs/`
- –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### üöÄ Production (Amvera)
- –ü—Ä–æ–≤–µ—Ä–∫–∞: `/data` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (–º–∞—É–Ω—Ç–∏—Ç—Å—è –∫–∞–∫ Persistent Storage)
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ –ø—É—Ç–∏ `/data/`, `/data/logs/`
- –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ Persistent Storage –∏ –ù–ï —Ç–µ—Ä—è—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–µ

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫ –ø–æ—Å–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### Production (Amvera):
```
Persistent Storage /data/
‚îú‚îÄ‚îÄ logs/
‚îÇ   ‚îî‚îÄ‚îÄ bot.log
‚îú‚îÄ‚îÄ audio_cache/
‚îÇ   ‚îú‚îÄ‚îÄ 0720a5f0.mp3
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ variants_cache/
‚îÇ   ‚îú‚îÄ‚îÄ 0720a5f0.json
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ users/
‚îÇ   ‚îî‚îÄ‚îÄ 278615297/
‚îÇ       ‚îú‚îÄ‚îÄ dictionaries/
‚îÇ       ‚îî‚îÄ‚îÄ sessions/
‚îî‚îÄ‚îÄ temp_sessions/
```

### –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ (–ª–æ–∫–∞–ª—å–Ω–æ):
```
–ü—Ä–æ–µ–∫—Ç ./data/
‚îú‚îÄ‚îÄ logs/
‚îÇ   ‚îî‚îÄ‚îÄ bot.log
‚îú‚îÄ‚îÄ audio_cache/
‚îÇ   ‚îú‚îÄ‚îÄ 0720a5f0.mp3
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ variants_cache/
‚îÇ   ‚îú‚îÄ‚îÄ 0720a5f0.json
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ users/
‚îÇ   ‚îî‚îÄ‚îÄ 278615297/
‚îÇ       ‚îú‚îÄ‚îÄ dictionaries/
‚îÇ       ‚îî‚îÄ‚îÄ sessions/
‚îî‚îÄ‚îÄ temp_sessions/
```

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

- ‚úÖ –°–∏–Ω—Ç–∞–∫—Å–∏—Å Python –ø—Ä–æ–≤–µ—Ä–µ–Ω (py_compile)
- ‚úÖ –í—Å–µ –∏–º–ø–æ—Ä—Ç—ã —Ä–∞–∑—Ä–µ—à–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º—ã–µ —Ñ–∞–π–ª—ã - –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∏–º–ø–æ—Ä—Ç—ã –∏–∑ config/settings
- ‚úÖ Backward compatibility —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ production

## üìù –§–∞–π–ª—ã, –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ –ø—Ä–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

1. **config/settings.py** - –æ—Å–Ω–æ–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—É—Ç–∏ –∫ –¥–∞–Ω–Ω—ã–º
2. **main.py** - –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞–ø–∫–∏ –ª–æ–≥–æ–≤

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å

- ‚úÖ –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ—Å—Ç–∞—é—Ç—Å—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –≤ `/data/users/{user_id}/`
- ‚úÖ –õ–æ–≥–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—É—Ç–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- ‚úÖ –ü–∞–ø–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `exists()` –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–ª–∞–Ω 0013 —É—Å–ø–µ—à–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω! –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç–µ–ø–µ—Ä—å:
- üü¢ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –ø–∞–ø–∫—É –Ω–∞ Amvera (Persistent Storage `/data/`)
- üü¢ –ù–µ —Ç–µ—Ä—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–µ –ø—Ä–æ–µ–∫—Ç–∞
- üü¢ –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ —Å –ª–æ–∫–∞–ª—å–Ω—ã–º–∏ –ø—É—Ç—è–º–∏
- üü¢ –ü–æ–ª–Ω–æ—Å—Ç—å—é backward compatible
