# Code Review: –î–æ—Ä–∞–±–æ—Ç–∫–∞ 0013 - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—É—Ç–µ–π —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è Amvera

## üìä –†–µ–∑—é–º–µ

‚úÖ **–ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ö–û–†–†–ï–ö–¢–ù–û**

**–°—Ç–∞—Ç—É—Å:** –£—Å–ø–µ—à–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å —Ö–æ—Ä–æ—à–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π
- **–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã:** 2 (–∫–∞–∫ —É–∫–∞–∑–∞–Ω–æ –≤ –ø–ª–∞–Ω–µ)
- **–ë–∞–≥–∏:** 0 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö, 2 –º–∞–ª—ã—Ö –∑–∞–º–µ—á–∞–Ω–∏—è
- **Over-engineering:** –ù–µ—Ç
- **–°—Ç–∏–ª—å –∫–æ–¥–∞:** –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ—Å—Ç–∞–ª—å–Ω–æ–π –±–∞–∑–µ
- **Backward compatibility:** ‚úÖ –ü–æ–ª–Ω–∞—è

---

## ‚úÖ –ß–¢–û –•–û–†–û–®–û –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

### 1. **config/settings.py** - –ò–¥–µ–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

```
üü¢ –õ–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏–π –≤–µ—Ä–Ω–∞
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω os.path.exists("/data") –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è production/dev
- –ë–æ–ª–µ–µ —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ, —á–µ–º –ø—Ä–æ–≤–µ—Ä–∫–∞ ENVIRONMENT –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø—É—Ç–∏ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
```

**–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã:**
- ‚úÖ –ß–µ—Ç–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö (—Å—Ç—Ä–æ–∫–∏ 30-31)
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–µ—Ä–∞—Ä—Ö–∏—è –ø—É—Ç–µ–π (–ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã–µ –ø—É—Ç–∏ –∑–∞–≤–∏—Å—è—Ç –æ—Ç DATA_DIR)
- ‚úÖ LOGS_DIR –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ `/data/logs` –≤ production
- ‚úÖ –í—Å–µ –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã–µ –ø—É—Ç–∏ (AUDIO_CACHE_DIR, VARIANTS_CACHE_DIR) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–º–µ—Å—Ç—è—Ç—Å—è –≤ `/data/`
- ‚úÖ –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç —Ö–∞—Ä–¥–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ –ø—É—Ç–∏ –≤ –æ—Å—Ç–∞–ª—å–Ω–æ–º –∫–æ–¥–µ

---

### 2. **main.py** - –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è

**–°—Ç—Ä–æ–∫–∏ 249-252:**
```python
LOGS_DIR.mkdir(parents=True, exist_ok=True)
```

‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç LOGS_DIR –∏–∑ settings (–∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –≤ —Å—Ç—Ä–æ–∫–µ 35)
- –°–æ–∑–¥–∞–µ—Ç –ø–∞–ø–∫—É –î–û –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (FileHandler —Ç—Ä–µ–±—É–µ—Ç —ç—Ç–æ–≥–æ)
- –•–æ—Ä–æ—à–∏–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ–±—ä—è—Å–Ω—è–µ—Ç –ø–æ—á–µ–º—É —ç—Ç–æ –Ω—É–∂–Ω–æ (—Å—Ç—Ä–æ–∫–∏ 249-251)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `parents=True, exist_ok=True` –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø–∞–ø–æ–∫ (—Ñ—É–Ω–∫—Ü–∏—è init_directories):**
- ‚úÖ –í—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞–ø–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è (—Å—Ç—Ä–æ–∫–∏ 133-138)
- ‚úÖ –í–∫–ª—é—á–∞–µ—Ç TEMP_SESSIONS_DIR (—Å—Ç—Ä–æ–∫–∞ 146)
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞–∫–∏–µ –ø–∞–ø–∫–∏ —Å–æ–∑–¥–∞–Ω—ã
- ‚úÖ –û—á–∏—Å—Ç–∫–∞ –∏—Å—Ç—ë–∫—à–∏—Ö —Å–µ—Å—Å–∏–π –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ (—Å—Ç—Ä–æ–∫–∏ 150-152)

---

### 3. **–ó–∞–≤–∏—Å–∏–º—ã–µ —Ñ–∞–π–ª—ã** - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ

#### ‚úÖ src/utils/file_helpers.py (—Å—Ç—Ä–æ–∫–∞ 11, 17)
```python
from config.settings import DATA_DIR
TEMP_SESSIONS_DIR = DATA_DIR / "temp_sessions"  # ‚Üí /data/temp_sessions/
```
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–æ–≤—ã–π DATA_DIR
- –§—É–Ω–∫—Ü–∏—è `ensure_user_directories` (—Å—Ç—Ä–æ–∫–∞ 224) –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–æ–∑–¥–∞–µ—Ç `/data/users/{user_id}/`
- –ù–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω—É–∂–Ω–æ ‚úÖ

#### ‚úÖ src/services/tts_service.py (—Å—Ç—Ä–æ–∫–∞ 13, 31)
```python
from config.settings import AUDIO_CACHE_DIR
self.cache_dir = AUDIO_CACHE_DIR  # ‚Üí /data/audio_cache/
```
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫—ç—à –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
- –°–æ–∑–¥–∞–µ—Ç –ø–∞–ø–∫—É –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (—Å—Ç—Ä–æ–∫–∞ 36)
- –ù–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω—É–∂–Ω–æ ‚úÖ

#### ‚úÖ src/services/variant_generator_service.py (—Å—Ç—Ä–æ–∫–∞ 12, 46)
```python
from config.settings import VARIANTS_CACHE_DIR
self.cache_dir = VARIANTS_CACHE_DIR  # ‚Üí /data/variants_cache/
```
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫—ç—à –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
- –°–æ–∑–¥–∞–µ—Ç –ø–∞–ø–∫—É –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (—Å—Ç—Ä–æ–∫–∞ 47)
- –ù–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω—É–∂–Ω–æ ‚úÖ

---

## ‚ö†Ô∏è –ú–ê–õ–´–ï –ó–ê–ú–ï–ß–ê–ù–ò–Ø (–¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è)

### –ó–∞–º–µ—á–∞–Ω–∏–µ 1: –ò–∑–±—ã—Ç–æ—á–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–∞–ø–æ–∫ (MINOR)

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–∞–ø–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –≤ –¥–≤—É—Ö –º–µ—Å—Ç–∞—Ö:

1. **main.py, —Å—Ç—Ä–æ–∫–∞ 252:** `LOGS_DIR.mkdir(parents=True, exist_ok=True)`
2. **main.py, —Ñ—É–Ω–∫—Ü–∏—è init_directories (—Å—Ç—Ä–æ–∫–∏ 133-147):** –°–Ω–æ–≤–∞ —Å–æ–∑–¥–∞–µ—Ç LOGS_DIR –∏ –¥—Ä—É–≥–∏–µ –ø–∞–ø–∫–∏

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```python
# –°—Ç—Ä–æ–∫–∞ 252: LOGS_DIR —Å–æ–∑–¥–∞–µ—Ç—Å—è
LOGS_DIR.mkdir(parents=True, exist_ok=True)

# –ü–æ—Ç–æ–º –≤ init_directories (—Å—Ç—Ä–æ–∫–∞ 137) —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å–Ω–æ–≤–∞
directories = [DATA_DIR, AUDIO_CACHE_DIR, VARIANTS_CACHE_DIR, LOGS_DIR]
for directory in directories:
    directory.mkdir(parents=True, exist_ok=True)
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –≠—Ç–æ –Ω–µ –æ—à–∏–±–∫–∞ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `exist_ok=True`), –Ω–æ –º–æ–∂–Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å:

```python
if __name__ == "__main__":
    # –¢–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –ø–∞–ø–∫–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –¥–ª—è FileHandler
    LOGS_DIR.mkdir(parents=True, exist_ok=True)
    
    # –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–∞–ø–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –≤ init_directories
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –Ω–æ –º–æ–∂–Ω–æ —Å–ª–µ–≥–∫–∞ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É. –ù–µ—Ç —Å—Ä–æ—á–Ω–æ—Å—Ç–∏.

---

### –ó–∞–º–µ—á–∞–Ω–∏–µ 2: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —è–≤–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –ø—É—Ç–∏ –≤ production

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –≤ production –Ω–µ—Ç —è–≤–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–æ–≥–æ, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø—É—Ç–∏ `/data/`

**–¢–µ–∫—É—â–∏–π –∫–æ–¥ (—Å—Ç—Ä–æ–∫–∏ 112-118):**
```python
logger.info(f"üìÅ –õ–æ–≥–∏ –ø–∏—à—É—Ç—Å—è –≤: {LOG_FILE}")

if CLEAR_LOGS_ON_START:
    logger.info("üßπ –†–µ–∂–∏–º –†–ê–ó–†–ê–ë–û–¢–ö–ò: –ª–æ–≥–∏ –æ—á–∏—â–∞—é—Ç—Å—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ")
else:
    logger.info(f"üîÑ –†–µ–∂–∏–º –ü–†–û–î–ê–ö–®–ï–ù–ê: —Ä–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤...")
```

**–£–ª—É—á—à–µ–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):** –î–æ–±–∞–≤–∏—Ç—å —è–≤–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–≥–æ –∫–∞–∫–æ–π —Ä–µ–∂–∏–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è (production vs dev):

```python
# –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–µ–∂–∏–º –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—É—Ç–µ–π
is_production = str(DATA_DIR).startswith("/data")
mode = "PRODUCTION (Amvera)" if is_production else "–†–ê–ó–†–ê–ë–û–¢–ö–ê"
logger.info(f"üåç –†–µ–∂–∏–º: {mode}")
logger.info(f"üìÅ DATA_DIR: {DATA_DIR}")
logger.info(f"üìÅ LOGS_DIR: {LOGS_DIR}")
```

**–°—Ç–∞—Ç—É—Å:** ‚ÑπÔ∏è –≠—Ç–æ —É–ª—É—á—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –∂–∏–∑–Ω–∏, –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ.

---

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–∫—Ä—ã—Ç–∏—è –ø–ª–∞–Ω–∞

| –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ –∏–∑ –ø–ª–∞–Ω–∞ | –°—Ç–∞—Ç—É—Å | –î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ |
|---|---|---|
| **–§–∞–∑–∞ 1: config/settings.py –æ–±–Ω–æ–≤–ª—ë–Ω** | ‚úÖ | –°—Ç—Ä–æ–∫–∏ 32-44 –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—é—Ç –ø—É—Ç–∏ |
| **–§–∞–∑–∞ 2: main.py –æ–±–Ω–æ–≤–ª—ë–Ω** | ‚úÖ | –°—Ç—Ä–æ–∫–∏ 35, 252 –∏—Å–ø–æ–ª—å–∑—É—é—Ç LOGS_DIR –∏–∑ settings |
| **DATA_DIR = /data –≤ production** | ‚úÖ | –°—Ç—Ä–æ–∫–∞ 34 |
| **LOGS_DIR = /data/logs –≤ production** | ‚úÖ | –°—Ç—Ä–æ–∫–∞ 35 |
| **AUDIO_CACHE_DIR –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—ë–Ω** | ‚úÖ | –°—Ç—Ä–æ–∫–∞ 43 –∑–∞–≤–∏—Å–∏—Ç –æ—Ç DATA_DIR |
| **VARIANTS_CACHE_DIR –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—ë–Ω** | ‚úÖ | –°—Ç—Ä–æ–∫–∞ 44 –∑–∞–≤–∏—Å–∏—Ç –æ—Ç DATA_DIR |
| **–õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å** | ‚úÖ | –°—Ç—Ä–æ–∫–∏ 38-40 fallback –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø—É—Ç–∏ |
| **Backward compatibility** | ‚úÖ | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è os.path.exists("/data") check |

---

## üîê –ê–ù–ê–õ–ò–ó –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò

‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ:**

1. **–ê–±—Å–æ–ª—é—Ç–Ω—ã–µ –ø—É—Ç–∏:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–±—Å–æ–ª—é—Ç–Ω—ã—Ö –ø—É—Ç–µ–π (`/data/`) –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ —á–µ–º –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ
2. **–ò–∑–æ–ª—è—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö:** `/data/users/{user_id}/` –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–∞
3. **–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:** Python `mkdir()` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç –ø–∞–ø–∫–∏ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º–∏
4. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ path traversal:** –í—Å–µ –ø—É—Ç–∏ –∂–µ—Å—Ç–∫–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤ settings, –Ω–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Å—Ç—Ä—É–∏—Ä–æ–≤–∞–Ω–∏—è

---

## üìã –°–¢–ò–õ–¨ –ò –°–û–ì–õ–ê–°–û–í–ê–ù–ù–û–°–¢–¨

‚úÖ **–°—Ç–∏–ª—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ—Å—Ç–∞–ª—å–Ω–æ–π –±–∞–∑–µ:**
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è Path() –æ–±—ä–µ–∫—Ç—ã –∫–∞–∫ –≤ –æ—Å—Ç–∞–ª—å–Ω–æ–º –∫–æ–¥–µ
- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Å —ç–º–æ–¥–∑–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Å—Ç–∏–ª—é –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–Ω—Ñ–∏–≥–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É style
- –ù–µ—Ç –∏–∑–ª–∏—à–Ω–µ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏

---

## üéØ –ò–¢–û–ì–û–í–´–ï –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### 1. ‚úÖ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û–ï (–¥–ª—è production)
- –£–¥–æ—Å—Ç–æ–≤–µ—Ä–∏—Ç–µ—Å—å —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è `ENVIRONMENT=production` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –≤ Amvera –∏–ª–∏ –ø–æ–ª–∞–≥–∞–π—Ç–µ—Å—å –Ω–∞ `os.path.exists("/data")` –ø—Ä–æ–≤–µ—Ä–∫—É (—Å–µ–π—á–∞—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤—Ç–æ—Ä–æ–π –ø–æ–¥—Ö–æ–¥ - ‚úÖ –ø—Ä–∞–≤–∏–ª—å–Ω–æ)

### 2. üìù –û–ü–¶–ò–û–ù–ê–õ–¨–ù–û (–¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è)
- –î–æ–±–∞–≤–∏—Ç—å —è–≤–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∂–∏–º–∞ (production vs dev) –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –±–æ—Ç–∞ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Å–æ–∑–¥–∞–Ω–∏—è –ø–∞–ø–æ–∫: –ª–∏–±–æ —Ç–æ–ª—å–∫–æ –≤ main, –ª–∏–±–æ —Ç–æ–ª—å–∫–æ –≤ init_directories

### 3. üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–æ–º)
```bash
# –ù–∞ Amvera —Å ENVIRONMENT=production:
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: /data/logs/bot.log
# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫—ç—à: /data/audio_cache/ –Ω–µ –ø—É—Å—Ç –ø–æ—Å–ª–µ –æ–∑–≤—É—á–∏–≤–∞–Ω–∏—è
# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç—ã: /data/variants_cache/ —Å–æ–¥–µ—Ä–∂–∏—Ç JSON —Ñ–∞–π–ª—ã
# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ: /data/users/{id}/
# 5. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏ —É–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –Ω–µ –ø–æ—Ç–µ—Ä—è–Ω—ã
```

---

## ‚úÖ –í–´–í–û–î

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –û–î–û–ë–†–ï–ù–ê** ‚úÖ

–ü–ª–∞–Ω 0013 —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω **–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é**. –ö–æ–¥:
- ‚úÖ –°–ª–µ–¥—É–µ—Ç –ø–ª–∞–Ω—É
- ‚úÖ –ù–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
- ‚úÖ –ò–º–µ–µ—Ç —Ö–æ—Ä–æ—à—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É
- ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–∏–ª—é –ø—Ä–æ–µ–∫—Ç–∞
- ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç backward compatibility

**–ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ production.**
